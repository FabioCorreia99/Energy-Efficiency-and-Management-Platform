import{_ as x,c as b,w as i,v as _,r,o as c,b as l,e as o,a as u,y as p,F as E,x as w,q as C,p as N}from"./index-g7Qn_UOI.js";const $={data(){return{alerts:[{id_notification:1,type:"Alert",message:"Consumo elevado: 94.8 kWh registados em 15/05/2025."},{id_notification:2,type:"Alert",message:"Custo energético estimado atingiu 16,32€ com este consumo."},{id_notification:3,type:"Alert",message:"Produção insuficiente: apenas 19.5 kWh gerados em 16/05/2025."},{id_notification:4,type:"Alert",message:"Consumo elevado: 105.2 kWh registados em 14/05/2025."}],loaded:!1}},methods:{async fetchAlerts(){var e;const a=_();try{const s=await fetch(`/users/${a.user.id_user}/notifications`,{headers:{Authorization:`Bearer ${a.token}`}}),n=await s.json();if(this.loaded=!0,!s.ok){console.error("Erro ao buscar notificações:",n.message);return}const t=((e=n.data)==null?void 0:e.notifications)||[];this.alerts=t.filter(d=>d.type==="Alert")}catch(s){this.loaded=!0,console.error("Erro ao buscar notificações:",s)}},async deleteAlert(a){var e,s,n;try{const t=_();(await fetch(`/notifications/${a}`,{method:"DELETE",headers:{Authorization:`Bearer ${t.token}`}})).ok?(this.alerts=this.alerts.filter(m=>m.id_notification!==a),(e=this.$toast)==null||e.success("Alerta eliminado.")):(s=this.$toast)==null||s.error("Erro ao eliminar alerta.")}catch(t){console.error("Erro ao eliminar alerta:",t),(n=this.$toast)==null||n.error("Erro ao eliminar alerta.")}}},mounted(){this.fetchAlerts()}},B={key:0},S={key:0,class:"text-center my-4"};function V(a,e,s,n,t,d){const m=r("v-row"),h=r("v-icon"),v=r("v-btn"),y=r("v-table"),g=r("v-progress-circular"),k=r("v-card"),A=r("v-container");return c(),b(A,{class:"py-6 px-6"},{default:i(()=>[l(m,{justify:"space-between",align:"center",class:"mb-4"},{default:i(()=>e[0]||(e[0]=[o("h1",{class:"text-h5 pl-2"},"Notificações de Alerta",-1)])),_:1}),l(k,{class:"pa-4"},{default:i(()=>[l(y,{density:"comfortable"},{default:i(()=>[e[3]||(e[3]=o("thead",null,[o("tr",null,[o("th",{class:"text-left"},"Notificaction"),o("th",{class:"text-left"},"Action")])],-1)),o("tbody",null,[(c(!0),u(E,null,w(t.alerts,f=>(c(),u("tr",{key:f.id_notification},[o("td",null,C(f.message),1),o("td",null,[l(v,{icon:"",variant:"text",color:"red-darken-1",onClick:j=>d.deleteAlert(f.id_notification),title:"Eliminar alerta"},{default:i(()=>[l(h,null,{default:i(()=>e[1]||(e[1]=[N("mdi-delete")])),_:1})]),_:2},1032,["onClick"])])]))),128)),t.alerts.length===0&&t.loaded?(c(),u("tr",B,e[2]||(e[2]=[o("td",{colspan:"2",class:"text-grey"},"Sem alertas no momento.",-1)]))):p("",!0)])]),_:1}),t.loaded?p("",!0):(c(),u("div",S,[l(g,{indeterminate:"",color:"primary"})]))]),_:1})]),_:1})}const z=x($,[["render",V]]);export{z as default};

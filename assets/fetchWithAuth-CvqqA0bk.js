import{z as f,v as u}from"./index-g7Qn_UOI.js";async function p(r,t={}){const n=f(),o=u(),s=o.token||sessionStorage.getItem("token")||null,i=s?`Bearer ${s}`:null,a={...t.headers,"Content-Type":"application/json",authorization:`${i}`,"Accept-Encoding":"gzip, deflate, br"};let e=await fetch(r,{...t,headers:a});const c=e.headers.get("content-encoding");if(console.log("Resposta comprimida com:",c),e.status===401&&o.refreshToken){if(await o.refreshAccessToken()){const h=o.token,d={...a,authorization:`Bearer ${h}`};if(e=await fetch(r,{...t,headers:d}),e.ok)return e}throw n.add({color:"error",text:"Unauthorized access. Please log in again."}),window.location.href="/login",new Error("Unauthorized after refresh")}if(e.status===403)throw n.add({color:"error",text:"Forbidden access. You do not have permission to perform this action."}),window.location.href="/forbidden",new Error("Forbidden access. You do not have permission to perform this action.");return e}export{p as f};

import{f as d}from"./fetchWithAuth-CvqqA0bk.js";import{_ as b,c as D,w as n,r as a,o as E,b as o,e as u,p as m}from"./index-g7Qn_UOI.js";const N={data(){return{headers:[{title:"ID",key:"id_user"},{title:"NAME",key:"name"},{title:"EMAIL",key:"email"},{title:"ADMIN",key:"admin"},{title:"ACTIONS",key:"actions",sortable:!1}],users:[],openDialog:!1,editingUser:null,form:{name:"",email:"",admin:!1},loading:!1,totalItems:0,page:1,itemsPerPage:10}},methods:{async fetchUsers(){this.loading=!0;try{const t=await d(`http://localhost:3000/users?limit=${this.itemsPerPage}&page=${this.page}`,{method:"GET"});if(!t.ok){const r=await t.json();throw new Error(r.message||"Network response was not ok")}const e=await t.json();this.users=e.users,this.totalItems=e.total}catch(t){throw t}finally{this.loading=!1}},editUser(t){this.editingUser=t,this.form.name=t.name,this.form.email=t.email,this.form.admin=t.admin,this.openDialog=!0},async deleteUser(t){try{const e=await d(`http://localhost:3000/users/${t.id_user}`,{method:"DELETE"});if(!e.ok){const r=await e.json();throw new Error(r.message||"Network response was not ok")}}catch(e){throw e}finally{this.fetchUsers()}},async saveUser(){try{const t=await d(`http://localhost:3000/users/${this.editingUser.id_user}`,{method:"PATCH",body:JSON.stringify({name:this.form.name,email:this.form.email,admin:this.form.admin})});if(!t.ok){const e=await t.json();throw new Error(e.message||"Network response was not ok")}}catch(t){throw t}finally{this.fetchUsers()}this.closeDialog()},closeDialog(){this.openDialog=!1,this.editingUser=null,this.form.name="",this.form.email="",this.form.admin=!1},onPageChange(t){this.page=parseInt(t),this.fetchUsers()}},mounted(){this.fetchUsers()},watch:{itemsPerPage(){this.page=1,this.fetchUsers()}}};function P(t,e,r,I,s,i){const h=a("v-row"),c=a("v-icon"),_=a("v-data-table-server"),g=a("v-card-title"),p=a("v-text-field"),v=a("v-checkbox"),w=a("v-card-text"),k=a("v-spacer"),f=a("v-btn"),U=a("v-card-actions"),y=a("v-card"),x=a("v-dialog"),V=a("v-container");return E(),D(V,{class:"container"},{default:n(()=>[o(h,{justify:"space-between",align:"center",class:"mb-4"},{default:n(()=>e[4]||(e[4]=[u("h1",{class:"text-h5 pl-4"},"User Management",-1)])),_:1}),o(_,{headers:s.headers,items:s.users,"items-per-page":s.itemsPerPage,"items-length":s.totalItems,loading:s.loading,page:s.page,"onUpdate:page":i.onPageChange,"item-value":"id_user",class:"elevation-1 p-0"},{"item.actions":n(({item:l})=>[o(c,{small:"",class:"me-2",onClick:C=>i.editUser(l)},{default:n(()=>e[5]||(e[5]=[m("mdi-pencil")])),_:2},1032,["onClick"]),o(c,{small:"",color:"red",onClick:C=>i.deleteUser(l)},{default:n(()=>e[6]||(e[6]=[m("mdi-delete")])),_:2},1032,["onClick"])]),_:1},8,["headers","items","items-per-page","items-length","loading","page","onUpdate:page"]),o(x,{modelValue:s.openDialog,"onUpdate:modelValue":e[3]||(e[3]=l=>s.openDialog=l),"max-width":"500px"},{default:n(()=>[o(y,null,{default:n(()=>[o(g,null,{default:n(()=>e[7]||(e[7]=[u("span",{class:"text-h6"},"Edit User",-1)])),_:1}),o(w,null,{default:n(()=>[o(p,{modelValue:s.form.name,"onUpdate:modelValue":e[0]||(e[0]=l=>s.form.name=l),variant:"outlined",label:"Name",required:""},null,8,["modelValue"]),o(p,{modelValue:s.form.email,"onUpdate:modelValue":e[1]||(e[1]=l=>s.form.email=l),variant:"outlined",label:"Email",required:""},null,8,["modelValue"]),o(v,{modelValue:s.form.admin,"onUpdate:modelValue":e[2]||(e[2]=l=>s.form.admin=l),label:"Admin"},null,8,["modelValue"])]),_:1}),o(U,null,{default:n(()=>[o(k),o(f,{text:"",onClick:i.closeDialog},{default:n(()=>e[8]||(e[8]=[m("Cancel")])),_:1},8,["onClick"]),o(f,{color:"primary",onClick:i.saveUser},{default:n(()=>e[9]||(e[9]=[m("Save")])),_:1},8,["onClick"])]),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}const M=b(N,[["render",P]]);export{M as default};

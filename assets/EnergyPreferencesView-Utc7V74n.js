import{u as g}from"./suppliers-DC_jdd6Q.js";import{u as _}from"./housings-D9vp8K79.js";import{_ as h,c as v,w as e,r as l,z as b,o as y,b as t,e as a,B as x,p as k}from"./index-g7Qn_UOI.js";import"./fetchWithAuth-CvqqA0bk.js";const w={data(){return{suppliersStore:g(),housingsStore:_(),messagesStore:b(),form:null,isSubmitting:!1,selectedSupplier:null,supplierRules:[r=>!!r||"Energy supplier is required"]}},computed:{suppliers(){return this.suppliersStore.suppliers},formattedSuppliers(){return this.suppliers.map(r=>({title:`${r.enterprise} - ${r.cost_kWh} €/kWh`,value:r.id}))}},methods:{formSubmit(){if(this.isSubmitting=!0,this.$refs.form.validate()){if(!this.selectedSupplier){this.messagesStore.add({color:"error",text:"Please select an energy supplier."}),this.isSubmitting=!1;return}try{this.housingsStore.updateHousing({id_supplier:this.selectedSupplier}),this.messagesStore.add({color:"success",text:"Energy supplier updated successfully."}),this.isSubmitting=!1}catch{this.messagesStore.add({color:"error",text:"Failed to update energy supplier. Please try again."}),this.isSubmitting=!1}}else{this.messagesStore.add({color:"error",text:"Please correct the errors in the form."}),this.isSubmitting=!1;return}}},mounted(){this.suppliersStore.fetchSuppliers("id,enterprise,cost_kWh"),console.log("✅ EnergyPreferenceView mounted!")}};function V(r,s,C,E,o,i){const n=l("v-row"),p=l("v-select"),u=l("v-col"),c=l("v-btn"),m=l("v-form"),d=l("v-card"),f=l("v-container");return y(),v(f,{class:"container"},{default:e(()=>[t(n,{justify:"space-between",align:"center",class:"mb-4"},{default:e(()=>s[1]||(s[1]=[a("h1",{class:"text-h5 pl-4"},"Energy Preferences",-1)])),_:1}),t(d,{class:"pa-4"},{default:e(()=>[s[3]||(s[3]=a("p",{class:"text-subtitle-1 mb-4"},"Select your current energy supplier",-1)),t(m,{ref:"form",onSubmit:x(i.formSubmit,["prevent"])},{default:e(()=>[t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[t(p,{variant:"outlined",label:"Energy Suppliers",density:"default",modelValue:o.selectedSupplier,"onUpdate:modelValue":s[0]||(s[0]=S=>o.selectedSupplier=S),clearable:!1,multiple:!1,placeholder:"Choose your current energy supplier",items:i.formattedSuppliers,"item-title":"title","item-value":"value",name:"Suppliers",rules:o.supplierRules},null,8,["modelValue","items","rules"])]),_:1})]),_:1}),t(n,null,{default:e(()=>[t(u,null,{default:e(()=>[t(c,{color:"primary",loading:o.isSubmitting,block:"",class:"mt-4",variant:"flat",size:"large",onClick:i.formSubmit},{default:e(()=>s[2]||(s[2]=[k(" Save Changes ")])),_:1},8,["loading","onClick"])]),_:1})]),_:1})]),_:1},8,["onSubmit"])]),_:1})]),_:1})}const z=h(w,[["render",V]]);export{z as default};
